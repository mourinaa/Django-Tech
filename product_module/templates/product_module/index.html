{% extends "base.html" %}
{% block title %}Products{% endblock %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Products</h1>
<p class="mb-4 text-gray-600">Role: {{ role }}</p>

<a href="{% url 'module_index' %}" class="px-3 py-1 bg-gray-400 text-white rounded hover:bg-gray-500 mb-4 inline-block">‚Üê Back to Module</a>
{% if role == "manager" or role == "user" %}
  <a href="{% url 'product_create' %}" class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600">+ Add Product</a>
{% endif %}

<table class="mt-4 w-full border-collapse bg-white shadow rounded">
  <thead>
    <tr class="bg-gray-200">
      <th class="p-2 border">Name</th>
      <th class="p-2 border">Barcode</th>
      <th class="p-2 border">Price</th>
      <th class="p-2 border">Stock</th>
      <th class="p-2 border">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for p in products %}
    <tr>
      <td class="p-2 border"><a class="text-blue-600 hover:underline" href="{% url 'product_detail' p.pk %}">{{ p.name }}</a></td>
      <td class="p-2 border">{{ p.barcode }}</td>
      <td class="p-2 border">{{ p.price }}</td>
      <td class="p-2 border">{{ p.stock }}</td>
      <td class="p-2 border space-x-2">
        {% if role in "manager user" %}
          <a href="{% url 'product_edit' p.pk %}" class="px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600">Edit</a>
        {% endif %}
        {% if role == "manager" %}
          <button type="button" class="px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600" onclick="confirmDelete('{{ p.pk }}')"> Delete </button>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<script>
  function confirmDelete(pk) {
    if (confirm('Are you sure you want to delete this product?')) {
      document.getElementById('delete-form-' + pk).submit();
    }
  }
</script>
{% endblock %}