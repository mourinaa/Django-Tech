{% extends "base.html" %}
{% block title %}Modules{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6 text-gray-800">Module Engine</h1>

<div class="bg-white shadow rounded-2xl overflow-hidden">
  <table class="w-full border-collapse">
    <thead>
      <tr class="bg-gray-100 text-left text-gray-700 uppercase text-sm">
        <th class="p-3">Name</th>
        <th class="p-3">Slug</th>
        <th class="p-3">Installed</th>
        <th class="p-3">Version</th>
        <th class="p-3 text-center">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for m in modules %}
      <tr class="border-b hover:bg-gray-50 {% if m.installed %}bg-green-50{% endif %}">
        <td class="p-3 font-medium text-gray-800">{{ m.name }}</td>
        <td class="p-3 text-gray-600">{{ m.slug }}</td>
        <td class="p-3">
          {% if m.installed %}
            <span class="px-2 py-1 text-xs rounded-full bg-green-200 text-green-800 font-semibold">Yes</span>
          {% else %}
            <span class="px-2 py-1 text-xs rounded-full bg-red-200 text-red-800 font-semibold">No</span>
          {% endif %}
        </td>
        <td class="p-3 text-gray-600">{{ m.version }}</td>
        <td class="p-3 text-center space-x-2">
          {% if not m.installed %}
            <form method="post" action="{% url 'install_module' m.slug %}" class="inline">
              {% csrf_token %}
              <button type="submit" class="px-3 py-1 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 shadow">
                Install
              </button>
            </form>
          {% else %}
            <form method="post" action="{% url 'upgrade_module' m.slug %}" class="inline">
              {% csrf_token %}
              <button type="submit" class="px-3 py-1 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 shadow">
                Upgrade
              </button>
            </form>
            <form method="post" action="{% url 'uninstall_module' m.slug %}" class="inline">
              {% csrf_token %}
              <button type="submit" class="px-3 py-1 text-sm bg-red-500 text-white rounded-lg hover:bg-red-600 shadow">
                Uninstall
              </button>
            </form>
            <a href="{% url 'product_index' %}" class="px-3 py-1 text-sm bg-green-500 text-white rounded-lg hover:bg-green-600 shadow">
              Open
            </a>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="5" class="p-6 text-center text-gray-500">No modules available.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}